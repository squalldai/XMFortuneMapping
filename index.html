<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>åæ·»é¦™ç²¾ç¼–å·åŠ å¯†è§£å¯†å·¥å…· v1.8.8</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f8f9fb;
      margin: 0;
      padding: 0;
      text-align: center;
    }

    header {
      background: linear-gradient(135deg, #ffecd2, #fcb69f);
      height: 15vh;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2rem;
      font-weight: bold;
      color: #333;
    }

    .container {
      max-width: 480px;
      margin: 20px auto;
      padding: 20px;
      background: #fff;
      border-radius: 16px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }

    h2 {
      margin-bottom: 12px;
      font-size: 1.2rem;
      color: #444;
    }

    .radio-group {
      margin: 12px 0;
      display: flex;
      justify-content: center;
      gap: 16px;
    }

    label {
      font-size: 0.95rem;
    }

    .io-block {
      margin: 20px 0;
      text-align: left;
    }

    .io-label {
      display: block;
      margin-bottom: 6px;
      font-size: 0.9rem;
      font-weight: bold;
      color: #555;
    }

    .input-row {
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .prefix-input {
      width: 90px;
      padding: 6px;
      border: 1px solid #ccc;
      border-radius: 6px;
      font-size: 0.9rem;
    }

    input[type="text"] {
      flex: 1;
      padding: 8px;
      border: 1px solid #ccc;
      border-radius: 6px;
      font-size: 1rem;
      text-align: center;
    }

    .buttons {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin: 20px 0;
    }

    button {
      padding: 10px 20px;
      border: none;
      border-radius: 10px;
      font-size: 1rem;
      cursor: pointer;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    button.encrypt {
      background: #4cafef;
      color: white;
    }

    button.decrypt {
      background: #ff7043;
      color: white;
    }

    button:hover {
      transform: scale(1.05);
      opacity: 0.9;
    }

    #log {
      margin-top: 20px;
      text-align: left;
      font-size: 0.85rem;
      max-height: 200px;
      overflow-y: auto;
      border-top: 1px solid #ddd;
      padding-top: 10px;
    }
  </style>
</head>
<body>
  <header>åæ·»é¦™ç²¾ç¼–å·åŠ å¯†è§£å¯†å·¥å…· v1.8.8</header>
  <div class="container">
    <h2>è¯´æ˜</h2>
    <p style="font-size:0.85rem;color:#555;font-style:italic;">
      å½“å‰ä»…æ”¯æŒADMæ¨¡å¼ã€‚åŠ å¯†æ—¶ï¼Œå·¦ä¾§è¾“å…¥å‰4ä½å›ºå®š7688ï¼Œå4ä½å¯ç¼–è¾‘ã€‚å³ä¾§è¾“å…¥4ä½æ•°å­—ã€‚åŠ å¯†è¾“å‡ºä¸º6ä½å­—ç¬¦+å³ä¾§4ä½æ•°å­—ã€‚è§£å¯†æ—¶ï¼Œè¾“å…¥å·¦å›ºå®šHT-ï¼Œå³ä¾§6ä½å­—ç¬¦ï¼Œè¾“å‡ºå·¦ä¾§8ä½æ•°å­—ï¼Œå³ä¾§4ä½æ•°å­—ã€‚ä¸¥æ ¼å¯é€†ã€‚
    </p>

    <h2>è¯·é€‰æ‹©æ¨¡å¼</h2>
    <div class="radio-group">
      <label><input type="radio" name="mode" value="ADM" checked> ADM</label>
      <label style="color: gray;"><input type="radio" name="mode" value="å¾·ä¹‹é¦¨" disabled> å¾·ä¹‹é¦¨(å¼€å‘ä¸­)</label>
    </div>

    <h2>è¯·é€‰æ‹©æ“ä½œ</h2>
    <div class="radio-group">
      <label><input type="radio" name="operation" value="encrypt" checked> åŠ å¯†</label>
      <label><input type="radio" name="operation" value="decrypt"> è§£å¯†</label>
    </div>

    <div class="io-block">
      <span class="io-label">è¾“å…¥æ•°å­—</span>
      <div class="input-row">
        <input type="text" id="prefixInput" class="prefix-input" value="76880800">
        <input type="text" id="mainInput" maxlength="6" placeholder="è¾“å…¥æ•°å­—">
      </div>
    </div>

    <div class="buttons">
      <button id="calcBtn" onclick="process()" class="encrypt">ğŸ”’ è®¡ç®—</button>
    </div>

    <div class="io-block">
      <span class="io-label">ç»“æœ</span>
      <div class="input-row">
        <input type="text" id="prefixOutput" class="prefix-input" value="HT-">
        <input type="text" id="output" readonly>
      </div>
    </div>

    <div id="log"></div>
  </div>

  <script>
    // --- å›ºå®šå¯†é’¥ ---
    const key = "ht1416";

    // --- å¯é€†å­—ç¬¦è¡¨ï¼ˆå»æ‰æ˜“æ··æ·†å­—ç¬¦ï¼‰ ---
    const chars = "23456789ABCDEFGHJKLMNPRSTUVWXYZ";

    function seededRandom(seed) {
      let h = 0;
      for (let i = 0; i < seed.length; i++) {
        h = (h * 31 + seed.charCodeAt(i)) >>> 0;
      }
      return function() {
        h ^= h << 13;
        h ^= h >>> 17;
        h ^= h << 5;
        return (h >>> 0) / 0xFFFFFFFF;
      };
    }

    function encryptADM(left4, right4) {
      const inputNum = left4 + right4; // 8ä½æ•°å­—
      const rng = seededRandom(key + inputNum);
      let output = "";
      for (let i = 0; i < 6; i++) {
        output += chars[Math.floor(rng() * chars.length)];
      }
      return output;
    }

    function decryptADM(sixChar, right4) {
      // å¯é€†æ–¹æ¡ˆï¼šç›´æ¥é€šè¿‡ä¼ªéšæœºå‡½æ•°éªŒè¯æ‰€æœ‰å¯èƒ½çš„å·¦4+right4ç»„åˆ
      // è¿™é‡Œå› ä¸ºè¾“å…¥ç©ºé—´å°ï¼Œ8ä½æ•°å­—çš„å4ä½å¯æšä¸¾0-9999
      const rightStr = right4.padStart(4, "0");
      for(let i=0;i<10000;i++){
        const left4 = i.toString().padStart(4,'0');
        const candidate = encryptADM(left4,rightStr);
        if(candidate === sixChar) return left4;
      }
      return null;
    }

    function process() {
      const mode = document.querySelector('input[name="mode"]:checked').value;
      const operation = document.querySelector('input[name="operation"]:checked').value;

      let prefix = document.getElementById("prefixInput").value.trim();
      let main = document.getElementById("mainInput").value.trim();
      let prefixOut = document.getElementById("prefixOutput");
      let output = document.getElementById("output");
      const btn = document.getElementById("calcBtn");

      // UIåˆ·æ–°
      if(operation === "decrypt"){
        document.getElementById("prefixInput").value = "HT-";
        document.getElementById("mainInput").value = "";
        prefix = "HT-";
      } else {
        document.getElementById("prefixInput").value = "7688" + prefix.slice(4);
      }
      output.value = "";
      prefixOut.value = "HT-";

      // æ ¡éªŒ
      if(operation === "encrypt"){
        if(!/^\d{4}$/.test(main)){
          alert("å³ä¾§è¾“å…¥å¿…é¡»ä¸º4ä½æ•°å­—ï¼");
          return;
        }
        const left4 = prefix.slice(4,8);
        const cipher = encryptADM(left4, main);
        output.value = cipher + main;
        btn.innerHTML = "ğŸ”’ è®¡ç®—";
        btn.className = "encrypt";
      } else {
        if(!/^[23456789ABCDEFGHJKLMNPRSTUVWXYZ]{6}$/.test(main)){
          alert("å³ä¾§è¾“å…¥å¿…é¡»ä¸º6ä½å­—ç¬¦ï¼");
          return;
        }
        const right4 = prompt("è¯·è¾“å…¥åŸå³ä¾§4ä½æ•°å­—ï¼Œç”¨äºè§£å¯†ï¼š","0000");
        const left4 = decryptADM(main,right4);
        if(left4===null){
          alert("è§£å¯†å¤±è´¥ï¼");
          return;
        }
        output.value = "7688" + left4 + right4;
        btn.innerHTML = "ğŸ”“ è®¡ç®—";
        btn.className = "decrypt";
      }

      // log
      const logEl = document.getElementById("log");
      const time = new Date().toLocaleTimeString();
      logEl.innerHTML = `<div>[${time}] æ¨¡å¼:${mode} æ“ä½œ:${operation} è¾“å…¥:${prefix}+${main} â†’ è¾“å‡º:${output.value}</div>` + logEl.innerHTML;
    }
  </script>
</body>
</html>
