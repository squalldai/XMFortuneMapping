<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>åæ·»é¦™ç²¾ç¼–å·åŠ å¯†è§£å¯†å·¥å…· v1.8.6</title>
<style>
  body {font-family: Arial,sans-serif; background:#f8f9fb; margin:0; padding:0; text-align:center;}
  header {background: linear-gradient(135deg,#ffecd2,#fcb69f); height:15vh; display:flex; align-items:center; justify-content:center; font-size:2rem; font-weight:bold; color:#333;}
  .container {max-width:480px; margin:10px auto; padding:15px; background:#fff; border-radius:16px; box-shadow:0 4px 12px rgba(0,0,0,0.1);}
  h2 {margin:10px 0; font-size:1.1rem; color:#444;}
  .radio-group {margin:8px 0; display:flex; justify-content:center; gap:16px;}
  label {font-size:0.95rem;}
  .io-block {margin:15px 0; text-align:left;}
  .io-label {display:block; margin-bottom:4px; font-size:0.9rem; font-weight:bold; color:#555;}
  .input-row {display:flex; align-items:center; gap:6px;}
  .prefix-input {width:90px; padding:6px; border:1px solid #ccc; border-radius:6px; font-size:0.9rem;}
  input[type="text"] {flex:1; padding:8px; border:1px solid #ccc; border-radius:6px; font-size:1rem; text-align:center;}
  .buttons {display:flex; justify-content:center; gap:20px; margin:15px 0;}
  button {padding:10px 20px; border:none; border-radius:10px; font-size:1rem; cursor:pointer; transition:all 0.2s; display:flex; align-items:center; gap:6px;}
  button.encrypt {background:#4cafef; color:white;}
  button.decrypt {background:#ff7043; color:white;}
  button:hover {transform:scale(1.05); opacity:0.9;}
  #log {margin-top:15px; text-align:left; font-size:0.85rem; max-height:200px; overflow-y:auto; border-top:1px solid #ddd; padding-top:8px;}
  .highlight {animation: flash 0.3s ease;}
  @keyframes flash {0% {background-color: rgba(0,0,0,0.1);} 50% {background-color: rgba(0,0,0,0.3);} 100% {background-color: rgba(0,0,0,0.1);}}
</style>
</head>
<body>
<header>åæ·»é¦™ç²¾ç¼–å·åŠ å¯†è§£å¯†å·¥å…· v1.8.6</header>
<div class="container">
<h2>è¯´æ˜</h2>
<p style="font-size:0.85rem; color:#555; font-style:italic;">
  ADMæ¨¡å¼ï¼šè¾“å…¥7688å¼€å¤´å¯ç¼–è¾‘8ä½æ•°å­—+å³ä¾§4ä½æ•°å­— â†’ è¾“å‡º6ä½æ•°å­—å­—æ¯ç»„åˆã€‚è§£å¯†ä¸¥æ ¼å¯é€†ï¼Œå¯¹åº”è¾“å…¥ï¼Œé˜²å‘†è®¾è®¡å»æ‰I,O,1,0ã€‚
</p>

<h2>è¯·é€‰æ‹©æ¨¡å¼</h2>
<div class="radio-group">
  <label><input type="radio" name="mode" value="ADM" checked> ADM</label>
  <label style="color: gray;"><input type="radio" name="mode" value="å¾·ä¹‹é¦¨" disabled> å¾·ä¹‹é¦¨(å¼€å‘ä¸­)</label>
</div>

<h2>è¯·é€‰æ‹©æ“ä½œ</h2>
<div class="radio-group">
  <label><input type="radio" name="operation" value="encrypt" checked> åŠ å¯†</label>
  <label><input type="radio" name="operation" value="decrypt"> è§£å¯†</label>
</div>

<div class="io-block">
  <span class="io-label">è¾“å…¥æ•°å­—</span>
  <div class="input-row">
    <input type="text" id="prefixInput" class="prefix-input" value="76880800">
    <input type="text" id="mainInput" maxlength="4" placeholder="è¾“å…¥4ä½æ•°å­—">
  </div>
</div>

<div class="buttons">
  <button id="calcButton" class="encrypt" onclick="process()">ğŸ”’ è®¡ç®—</button>
</div>

<div class="io-block">
  <span class="io-label">ç»“æœ</span>
  <div class="input-row">
    <input type="text" id="prefixOutput" class="prefix-input" value="HT-">
    <input type="text" id="output" readonly>
  </div>
</div>

<div id="log"></div>
</div>

<script>
function seededRandom(seed){
    let h=0;for(let i=0;i<seed.length;i++){h=(h*31+seed.charCodeAt(i))>>>0;}
    return function(){h^=h<<13; h^=h>>>17; h^=h<<5; return (h>>>0)/0xFFFFFFFF;};
}

function generatePermutation(seed){
    const rng=seededRandom(seed);
    // æ”¹è¿›ï¼šå…ˆæ’æ•°å­—åœ¨å‰ï¼Œå­—æ¯åœ¨å
    const digits=['2','3','4','5','6','7','8','9'];
    const letters='ABCDEFGHJKLMNPQRSTUVWXYZ'.split('');
    const chars=[...digits,...letters]; // æ•°å­—åœ¨å‰
    const arr=[];
    for(let i=0;i<10000;i++){
        let s=''; for(let j=0;j<6;j++){s+=chars[Math.floor(rng()*chars.length)];}
        arr.push(s);
    }
    const map=new Map();
    const rmap=new Map();
    arr.forEach((val,idx)=>{
        const key=idx.toString().padStart(4,'0');
        map.set(key,val);
        rmap.set(val,key);
    });
    return {map,rmap};
}

const key="ht1416";
const {map: encMap,rmap: decMap}=generatePermutation(key);

function flashModule(){
    const container=document.querySelector('.container');
    container.classList.add('highlight');
    setTimeout(()=>{container.classList.remove('highlight');},300);
}

function process(){
    const mode=document.querySelector('input[name="mode"]:checked').value;
    const operation=document.querySelector('input[name="operation"]:checked').value;

    let prefix=document.getElementById("prefixInput").value.trim();
    let main=document.getElementById("mainInput").value.trim();
    let output=document.getElementById("output");
    output.value='';

    // è¾“å…¥éªŒè¯
    if(!/^\d+$/.test(main) || main.length!==4){
        alert("å³ä¾§è¾“å…¥å¿…é¡»4ä½æ•°å­—ï¼");
        return;
    }
    if(!/^7688/.test(prefix)){
        alert("å·¦ä¾§è¾“å…¥å¿…é¡»ä»¥7688å¼€å¤´ï¼");
        return;
    }

    let inputKey=prefix.slice(-4)+main; // 8ä½å¯å˜éƒ¨åˆ†
    let result='';
    if(operation==='encrypt'){
        const last4=inputKey.slice(-4);
        result=encMap.get(last4);
    }else{
        if(!decMap.has(main)){
            alert("æ— æ³•è§£å¯†ï¼");
            return;
        }
        result=decMap.get(main);
    }

    output.value=result;
    flashModule();

    // log
    const log=document.getElementById("log");
    const time=new Date().toLocaleTimeString();
    log.innerHTML=`[${time}] æ¨¡å¼:${mode} æ“ä½œ:${operation} è¾“å…¥:${prefix}+${main} â†’ è¾“å‡º:${result}<br>`+log.innerHTML;
}
</script>
</body>
</html>
