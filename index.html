<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>åæ·»é¦™ç²¾ç¼–å·åŠ å¯†è§£å¯†å·¥å…· v1.8.12</title>
<style>
body {
  font-family: Arial, sans-serif;
  background: #f8f9fb;
  margin: 0;
  padding: 0;
  text-align: center;
}
header {
  background: linear-gradient(135deg, #ffecd2, #fcb69f);
  height: 12vh;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1.8rem;
  font-weight: bold;
  color: #333;
}
.container {
  max-width: 480px;
  margin: 10px auto;
  padding: 15px;
  background: #fff;
  border-radius: 16px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.1);
}
.description {
  font-size: 0.85rem;
  color: #555;
  font-style: italic;
  background: rgba(230,230,230,0.3);
  padding: 6px 10px;
  border-radius: 10px;
  margin-bottom: 10px;
  text-align: left;
}
h2 {
  margin-bottom: 8px;
  font-size: 1.1rem;
  color: #444;
}
.radio-group {
  margin: 8px 0;
  display: flex;
  justify-content: center;
  gap: 16px;
}
label {
  font-size: 0.95rem;
}
.io-block {
  margin: 14px 0;
  text-align: left;
}
.io-label {
  display: block;
  margin-bottom: 4px;
  font-size: 0.9rem;
  font-weight: bold;
  color: #555;
}
.input-row {
  display: flex;
  align-items: center;
  gap: 6px;
}
.prefix-input {
  width: 90px;
  padding: 6px;
  border: 1px solid #ccc;
  border-radius: 6px;
  font-size: 0.85rem;
  text-align: center;
}
input[type="text"] {
  flex: 1;
  padding: 6px;
  border: 1px solid #ccc;
  border-radius: 6px;
  font-size: 0.95rem;
  text-align: center;
}
.calc-container {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 10px;
  padding: 10px;
  border-radius: 12px;
  transition: background 0.4s;
}
.buttons {
  display: flex;
  justify-content: center;
  gap: 20px;
  margin: 10px 0;
}
button {
  padding: 10px 22px;
  border: none;
  border-radius: 10px;
  font-size: 1rem;
  cursor: pointer;
  transition: all 0.2s;
  display: flex;
  align-items: center;
  gap: 6px;
}
button.encrypt {
  background: #4cafef;
  color: white;
}
button.decrypt {
  background: #ff7043;
  color: white;
}
button:hover {
  transform: scale(1.05);
  opacity: 0.9;
}
#log {
  margin-top: 15px;
  text-align: left;
  font-size: 0.85rem;
  max-height: 200px;
  overflow-y: auto;
  border-top: 1px solid #ddd;
  padding-top: 8px;
}
</style>
</head>
<body>
<header>åæ·»é¦™ç²¾ç¼–å·åŠ å¯†è§£å¯†å·¥å…· v1.8.12</header>
<div class="container">
<div class="description">
å½“å‰ä»…æ”¯æŒ ADM æ¨¡å¼ã€‚åŠ å¯†æ—¶è¾“å…¥å³ä¾§å››ä½æ•°å­—ï¼Œå·¦ä¾§å›ºå®š7688+å¯ç¼–è¾‘åå››ä½ï¼›è¾“å‡ºå³ä¾§6ä½å­—ç¬¦å¯†æ–‡ã€‚è§£å¯†æ—¶è¾“å…¥å³ä¾§6ä½å­—ç¬¦ï¼Œå·¦ä¾§å›ºå®šHT-ï¼›è¾“å‡ºå·¦ä¾§æ˜¾ç¤º7688+åå››ä½ï¼Œå³ä¾§æ˜¾ç¤ºå³å››ä½æ•°å­—ã€‚ç‚¹å‡»è®¡ç®—æŒ‰é’®æ—¶è¾“å…¥è¾“å‡ºæ¨¡å—ä¼šé—ªçƒå¯¹åº”é¢œè‰²ã€‚
</div>

<h2>è¯·é€‰æ‹©æ¨¡å¼</h2>
<div class="radio-group">
<label><input type="radio" name="mode" value="ADM" checked> ADM</label>
<label style="color: gray;"><input type="radio" name="mode" value="å¾·ä¹‹é¦¨" disabled> å¾·ä¹‹é¦¨(å¼€å‘ä¸­)</label>
</div>

<h2>è¯·é€‰æ‹©æ“ä½œ</h2>
<div class="radio-group">
<label><input type="radio" name="operation" value="encrypt" checked> åŠ å¯†</label>
<label><input type="radio" name="operation" value="decrypt"> è§£å¯†</label>
</div>

<div class="calc-container" id="calcContainer">
<div class="io-block">
<span class="io-label">è¾“å…¥</span>
<div class="input-row">
<input type="text" id="prefixInput" class="prefix-input" value="76880800">
<input type="text" id="mainInput" maxlength="4" placeholder="è¾“å…¥4ä½æ•°å­—">
</div>
</div>

<div class="buttons">
<button id="calcBtn" class="encrypt" onclick="process()">ğŸ”’ è®¡ç®—</button>
</div>

<div class="io-block">
<span class="io-label">ç»“æœ</span>
<div class="input-row">
<input type="text" id="prefixOutput" class="prefix-input" value="HT-" readonly>
<input type="text" id="output" readonly>
</div>
</div>
</div>

<div id="log"></div>
</div>

<script>
// --- ç®—æ³•éƒ¨åˆ† ---
function seededRandom(seed){
  let h=0;
  for(let i=0;i<seed.length;i++){
    h=(h*31+seed.charCodeAt(i))>>>0;
  }
  return function(){
    h^=h<<13;
    h^=h>>>17;
    h^=h<<5;
    return (h>>>0)/0xFFFFFFFF;
  }
}

function generatePermutation(seed, chars){
  const rng=seededRandom(seed);
  let arr=chars.split('');
  for(let i=arr.length-1;i>0;i--){
    const j=Math.floor(rng()*(i+1));
    [arr[i],arr[j]]=[arr[j],arr[i]];
  }
  const map=new Map();
  const rmap=new Map();
  arr.forEach((c,i)=>{
    map.set(chars[i],c);
    rmap.set(c,chars[i]);
  });
  return {map,rmap};
}

const key="ht1416";
const charset='ABCDEFGHJKLMNPQRSTUVWXYZ23456789';
const {map:encMap,rmap:decMap}=generatePermutation(key,charset);

// --- UIåŠè®¡ç®— ---
function process(){
  const operation=document.querySelector('input[name="operation"]:checked').value;
  const prefixInput=document.getElementById('prefixInput');
  const mainInput=document.getElementById('mainInput');
  const prefixOutput=document.getElementById('prefixOutput');
  const output=document.getElementById('output');
  const calcContainer=document.getElementById('calcContainer');
  const calcBtn=document.getElementById('calcBtn');

  if(operation==='decrypt'){
    prefixInput.value='HT-';
    prefixInput.readOnly=true;
    mainInput.maxLength=6;
    mainInput.placeholder='è¾“å…¥6ä½å­—ç¬¦';
    mainInput.value='';
    prefixOutput.value='';
    output.value='';
    calcBtn.textContent='ğŸ”“ è®¡ç®—';
    calcBtn.className='decrypt';
    calcContainer.style.background='transparent';
  } else {
    prefixInput.readOnly=false;
    mainInput.maxLength=4;
    mainInput.placeholder='è¾“å…¥4ä½æ•°å­—';
    prefixOutput.value='HT-';
    output.value='';
    calcBtn.textContent='ğŸ”’ è®¡ç®—';
    calcBtn.className='encrypt';
    calcContainer.style.background='transparent';
  }

  let left=prefixInput.value.trim();
  let right=mainInput.value.trim();

  if(operation==='encrypt'){
    if(!/^\d{4}$/.test(right) || !/^7688\d{4}$/.test(left)){
      alert('å·¦ä¾§å¿…é¡»7688å¼€å¤´8ä½æ•°å­—ï¼Œå³ä¾§è¾“å…¥4ä½æ•°å­—ï¼');
      return;
    }
    let combined = left.slice(4)+right;
    let res='';
    for(let i=0;i<6;i++){
      let idx=parseInt(combined[i%combined.length])%charset.length;
      res+=encMap.get(charset[idx]);
    }
    output.value=res;
    prefixOutput.value='HT-';
    flash(calcContainer, '#4cafef');
  } else {
    if(!/^[A-HJ-NP-Z2-9]{6}$/.test(right)){
      alert('å³ä¾§è¾“å…¥å¿…é¡»6ä½å­—ç¬¦ï¼ˆæ— I,O,1,0ï¼‰ï¼');
      return;
    }
    let decoded='';
    for(let i=0;i<6;i++){
      decoded+=decMap.get(right[i])||'?';
    }
    let outLeft='7688'+decoded.slice(0,4);
    let outRight=decoded.slice(4,8);
    prefixOutput.value=outLeft;
    output.value=outRight;
    flash(calcContainer, '#ff7043');
  }

  const log = document.getElementById('log');
  const time = new Date().toLocaleTimeString();
  log.innerHTML=`<div>[${time}] æ“ä½œ:${operation} è¾“å…¥:${left}+${right} â†’ è¾“å‡º:${prefixOutput.value}+${output.value}</div>`+log.innerHTML;
}

function flash(container,color){
  container.style.background=color+'33';
  setTimeout(()=>{container.style.background=color+'22';},150);
  setTimeout(()=>{container.style.background='transparent';},500);
}
</script>
</body>
</html>
