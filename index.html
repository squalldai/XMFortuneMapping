<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>加解密工具 3.0</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    h2 { margin-bottom: 10px; }
    .section { margin-bottom: 20px; }
    label { margin-right: 10px; }
    input[type="text"] { width: 250px; padding: 5px; margin: 5px 0; }
    button { padding: 5px 15px; margin: 5px; }
    #output { margin-top: 10px; font-weight: bold; }
  </style>
</head>
<body>
  <h2>加解密工具 v3.0</h2>

  <div class="section">
    <label><input type="radio" name="mode" value="adm" checked> ADM</label>
    <label><input type="radio" name="mode" value="sensient"> 森馨</label>
  </div>

  <div class="section">
    <label><input type="radio" name="action" value="encrypt" checked> 加密</label>
    <label><input type="radio" name="action" value="decrypt"> 解密</label>
  </div>

  <div id="input-area" class="section"></div>

  <div class="section">
    <button onclick="run()">执行</button>
  </div>

  <div id="output" class="section"></div>

  <script src="ADM.js"></script>
  <script src="SENSIENT.js"></script>
  <script>
    const inputArea = document.getElementById("input-area");
    const outputDiv = document.getElementById("output");

    function renderUI() {
      const mode = document.querySelector('input[name="mode"]:checked').value;
      const action = document.querySelector('input[name="action"]:checked').value;
      inputArea.innerHTML = "";

      if (mode === "adm") {
        if (action === "encrypt") {
          inputArea.innerHTML = `
            左侧输入: <input type="text" id="leftInput" value="7688"><br>
            右侧输入: <input type="text" id="rightInput" placeholder="请输入4位数字">
          `;
        } else {
          inputArea.innerHTML = `
            左侧固定: <input type="text" id="leftInput" value="HT-" disabled><br>
            右侧输入: <input type="text" id="rightInput" placeholder="请输入6位加密串">
          `;
        }
      } else if (mode === "sensient") {
        if (action === "encrypt") {
          inputArea.innerHTML = `
            输入: <input type="text" id="singleInput" placeholder="2数字+2字母+4数字 (共8位)">
          `;
        } else {
          inputArea.innerHTML = `
            左侧固定: <input type="text" id="leftInput" value="HT-" disabled><br>
            右侧输入: <input type="text" id="rightInput" placeholder="请输入6位加密串">
          `;
        }
      }
    }

    function run() {
      const mode = document.querySelector('input[name="mode"]:checked').value;
      const action = document.querySelector('input[name="action"]:checked').value;
      outputDiv.innerHTML = "";

      if (mode === "adm") {
        if (action === "encrypt") {
          const left = document.getElementById("leftInput").value.trim();
          const right = document.getElementById("rightInput").value.trim();
          if (!/^\d{4}$/.test(right)) {
            outputDiv.innerHTML = "右侧必须是4位数字";
            return;
          }
          const result = admEncrypt(left + right);
          outputDiv.innerHTML = "输出: " + result;
        } else {
          const right = document.getElementById("rightInput").value.trim();
          if (!/^[A-Z0-9]{6}$/.test(right)) {
            outputDiv.innerHTML = "右侧必须是6位字母或数字";
            return;
          }
          const result = admDecrypt("HT-" + right);
          outputDiv.innerHTML = "输出: " + result;
        }
      } else if (mode === "sensient") {
        if (action === "encrypt") {
          const input = document.getElementById("singleInput").value.trim();
          if (!/^\d{2}[A-Z]{2}\d{4}$/.test(input)) {
            outputDiv.innerHTML = "输入必须是2数字+2字母+4数字 (共8位)";
            return;
          }
          const result = sensientEncrypt(input);
          outputDiv.innerHTML = "输出: " + result;
        } else {
          const right = document.getElementById("rightInput").value.trim();
          if (!/^[A-Z0-9]{6}$/.test(right)) {
            outputDiv.innerHTML = "右侧必须是6位字母或数字";
            return;
          }
          const result = sensientDecrypt("HT-" + right);
          outputDiv.innerHTML = "输出: " + result;
        }
      }
    }

    document.querySelectorAll('input[name="mode"]').forEach(el => el.addEventListener("change", renderUI));
    document.querySelectorAll('input[name="action"]').forEach(el => el.addEventListener("change", renderUI));

    renderUI();
  </script>
</body>
</html>
