<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>å››ä½æ•°å­—åŠ å¯†è§£å¯†</title>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
<style>
body { font-family: 'Roboto', sans-serif; margin:0;padding:20px;background:#f0f2f5; color:#333; }
canvas#logoCanvas { display:block; margin:0 auto 10px auto; width:100%; height:80px; } 
h2 { text-align:center;color:#1976d2;margin-bottom:10px;font-weight:700; }
.description { text-align:center;color:#555;font-size:0.95em;margin-bottom:20px; line-height:1.5; }
.card { background: rgba(255,255,255,0.9); backdrop-filter: blur(6px); border-radius:16px; padding:20px; margin-bottom:20px; box-shadow: 0 6px 25px rgba(0,0,0,0.08); }
.panel { background: rgba(255,255,255,0.6); border-radius:14px; padding:15px; display:flex; flex-direction:column; align-items:center; gap:12px; transition: background-color 0.6s, box-shadow 0.3s; }
label { font-weight:500;margin-bottom:6px;display:block; text-align:left; width:100%; }
.input-row, .result-row { display:flex; align-items:center; gap:8px; width:100%; max-width:360px; }
.static-text { font-weight:600; color:#555; min-width:80px; text-align:right; }
.dynamic-prefix { font-weight:700; min-width:70px; text-align:right; transition: all 0.3s; display:inline-block; }
.dynamic-encrypt { font-size:1.196em; color:#1976d2; } 
.dynamic-decrypt { font-size:1.196em; color:#f57c00; }
input[type="tel"], input[type="text"] {
    flex-grow:1; font-size:1.104em; padding:6.8px; border-radius:8.5px; border:1px solid #ccc;
    text-align:center; letter-spacing:3px; box-sizing:border-box; max-width:136px;
    box-shadow: inset 0 1.7px 3.4px rgba(0,0,0,0.06); transition: border 0.3s, box-shadow 0.3s;
}
input:focus { outline:none; border-color:#1976d2; box-shadow:0 0 6.8px rgba(25,118,210,0.2) inset; }
.buttons { display:flex; gap:12px; width:100%; max-width:360px; }
.btn { flex:1; padding:10px; border-radius:12px; border:none; color:#fff; font-size:1em; cursor:pointer; display:flex; align-items:center; justify-content:center; gap:6px; font-weight:500; transition: all 0.2s ease; }
.btn:hover { transform: translateY(-2px); box-shadow:0 3px 10px rgba(0,0,0,0.15); }
#encryptBtn{background: linear-gradient(135deg,#42a5f5,#1976d2); box-shadow:0 3px 10px rgba(25,118,210,0.25);}
#decryptBtn{background: linear-gradient(135deg,#ffb74d,#f57c00); box-shadow:0 3px 10px rgba(255,152,0,0.25);}
.mode-indicator { text-align:center;padding:6px;font-weight:600;margin-bottom:12px;border-radius:12px;font-size:0.95em; box-shadow: inset 0 0 0 rgba(0,0,0,0); transition: background 0.6s, color 0.6s; }
.mode-encrypt{background:#eaf6ff;color:#0b57a8;}
.mode-decrypt{background:#fff7ea;color:#9f5600;}
@keyframes flash { 0% { background-color: rgba(25,118,210,0.4);} 100% { background-color: rgba(25,118,210,0.12);} }
@keyframes flash-decrypt { 0% { background-color: rgba(255,152,0,0.4);} 100% { background-color: rgba(255,152,0,0.12);} }
.flash-encrypt { animation: flash 0.6s forwards; }
.flash-decrypt { animation: flash-decrypt 0.6s forwards; }
</style>
</head>
<body>

<!-- é£Ÿå“ä¸»é¢˜å¤æ‚åƒç´ é£ logo -->
<canvas id="logoCanvas"></canvas>

<h2>ğŸ” å››ä½æ•°å­—åŠ å¯†è§£å¯†</h2>
<p class="description">è¾“å…¥å››ä½æ•°å­—å¹¶åŠ å¯†æˆ–è§£å¯†ã€‚ä½¿ç”¨å›ºå®šå¯†é’¥ <b>ht1416</b>ï¼Œä¿è¯å”¯ä¸€æ˜ å°„ï¼Œå¯é€†å¯è¿˜åŸã€‚</p>

<div class="card">
  <div>
    <label>é€‰æ‹©æ¨¡å¼</label>
    <label><input type="radio" name="mode" value="ADM" checked> ADM</label>
    <label><input type="radio" name="mode" value="DZC" disabled> <span style="color:gray;">å¾·ä¹‹é¦¨(å¼€å‘ä¸­)</span></label>
  </div>

  <div id="modeIndicator" class="mode-indicator">å½“å‰æ¨¡å¼ï¼šå¾…é€‰æ‹©</div>

  <div id="operationPanel" class="panel">
    <div class="input-row">
      <span class="static-text">è¾“å…¥æ•°å­—ï¼š</span>
      <span id="inputDynamic" class="dynamic-prefix"></span>
      <input id="inputNum" type="tel" maxlength="4" placeholder="4ä½"/>
    </div>

    <div class="buttons">
      <button id="encryptBtn" class="btn">ğŸ”’ åŠ å¯†</button>
      <button id="decryptBtn" class="btn">ğŸ”“ è§£å¯†</button>
    </div>

    <div class="result-row">
      <span class="static-text">ç»“æœï¼š</span>
      <span id="outputDynamic" class="dynamic-prefix"></span>
      <input id="outputNum" type="text" readonly />
    </div>
  </div>
</div>

<script>
// ---------- é£Ÿå“ä¸»é¢˜å¤æ‚åƒç´ é£ logo ----------
const canvas = document.getElementById('logoCanvas');
const ctx = canvas.getContext('2d');

function drawFoodComplexLogo(){
    const w = canvas.width = canvas.clientWidth;
    const h = canvas.height = canvas.clientHeight;
    const px = Math.floor(h/10); // åŸºç¡€åƒç´ å—å¤§å°
    ctx.clearRect(0,0,w,h);
    
    // èƒŒæ™¯
    ctx.fillStyle="#f0f2f5";
    ctx.fillRect(0,0,w,h);

    // å¤šä¸ªé¥®æ–™
    ctx.fillStyle="#42a5f5"; ctx.fillRect(px, px*2, px*2, px*5);
    ctx.fillStyle="#1976d2"; ctx.fillRect(px*2, px, px, px); // å¸ç®¡
    ctx.fillStyle="#4fc3f7"; ctx.fillRect(px*4, px*3, px*2, px*5);
    ctx.fillStyle="#0288d1"; ctx.fillRect(px*5, px*2, px, px); // å¸ç®¡

    // è›‹ç³•/çƒ˜ç„™å“
    ctx.fillStyle="#ffb74d"; ctx.fillRect(px*7, px*4, px*3, px*3);
    ctx.fillStyle="#f57c00"; ctx.fillRect(px*7, px*3, px*3, px); // ç³–éœœ
    ctx.fillStyle="#ff8a65"; ctx.fillRect(px*11, px*4, px*2, px*3);
    ctx.fillStyle="#d84315"; ctx.fillRect(px*11, px*3, px*2, px); // ç³–éœœ

    // ç³–æœ
    ctx.fillStyle="#f48fb1"; ctx.fillRect(px*2, px*8, px, px);
    ctx.fillStyle="#ce93d8"; ctx.fillRect(px*3, px*8, px, px);
    ctx.fillStyle="#ffb74d"; ctx.fillRect(px*5, px*8, px, px);
    ctx.fillStyle="#81c784"; ctx.fillRect(px*6, px*8, px, px);

    // é¥¼å¹²
    ctx.fillStyle="#bcaaa4"; ctx.fillRect(px*9, px*8, px, px);
    ctx.fillStyle="#a1887f"; ctx.fillRect(px*10, px*8, px, px);
}
drawFoodComplexLogo();

// ---------- å¯†é’¥é©±åŠ¨ä¼ªéšæœºåŒå°„é€»è¾‘ ----------
const KEY = "ht1416";
function hashSeed(str) {
    let hash = 0;
    for(let i=0;i<str.length;i++){
        hash = (hash*31 + str.charCodeAt(i)) % 1000000000;
    }
    return hash;
}
function PRNG(seed){
    return function(){
        seed |= 0;
        seed = (seed + 0x6D2B79F5)|0;
        let t = Math.imul(seed ^ seed>>>15, 1 | seed);
        t = (t + Math.imul(t ^ t>>>7, 61 | t)) ^ t;
        return ((t ^ t>>>14) >>>0)/4294967296;
    }
}
function generatePermutation(seed){
    const rand = PRNG(seed);
    const arr = [];
    for(let i=0;i<10000;i++) arr.push(i);
    for(let i=arr.length-1;i>0;i--){
        const j = Math.floor(rand()* (i+1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
    }
    return arr;
}
const seed = hashSeed(KEY);
const permutation = generatePermutation(seed);
const encryptMap = {};
const decryptMap = {};
for(let i=0;i<10000;i++){
    const key = i.toString().padStart(4,'0');
    const val = permutation[i].toString().padStart(4,'0');
    encryptMap[key]=val;
    decryptMap[val]=key;
}

// ---------- é¡µé¢é€»è¾‘ ----------
const input = document.getElementById('inputNum');
const output = document.getElementById('outputNum');
const inputDynamic = document.getElementById('inputDynamic');
const outputDynamic = document.getElementById('outputDynamic');
const modeIndicator = document.getElementById('modeIndicator');
const operationPanel = document.getElementById('operationPanel');

function highlight(mode){
  operationPanel.classList.remove("flash-encrypt","flash-decrypt");
  void operationPanel.offsetWidth;
  operationPanel.classList.add(mode==="encrypt"?"flash-encrypt":"flash-decrypt");
}

document.getElementById('encryptBtn').addEventListener('click', ()=>{
  let val = input.value.trim();
  if(!/^\d{4}$/.test(val)){ alert("è¯·è¾“å…¥å››ä½æ•°å­—"); return; }
  output.value = encryptMap[val];
  inputDynamic.textContent = "800880";
  outputDynamic.textContent = "HT-";
  inputDynamic.className = "dynamic-prefix dynamic-encrypt";
  outputDynamic.className = "dynamic-prefix dynamic-encrypt";
  modeIndicator.textContent = "å½“å‰æ¨¡å¼ï¼šåŠ å¯†";
  modeIndicator.className = "mode-indicator mode-encrypt";
  highlight("encrypt");
});

document.getElementById('decryptBtn').addEventListener('click', ()=>{
  let val = input.value.trim();
  if(!/^\d{4}$/.test(val)){ alert("è¯·è¾“å…¥å››ä½æ•°å­—"); return; }
  output.value = decryptMap[val];
  inputDynamic.textContent = "HT-";
  outputDynamic.textContent = "800880";
  inputDynamic.className = "dynamic-prefix dynamic-decrypt";
  outputDynamic.className = "dynamic-prefix dynamic-decrypt";
  modeIndicator.textContent = "å½“å‰æ¨¡å¼ï¼šè§£å¯†";
  modeIndicator.className = "mode-indicator mode-decrypt";
  highlight("decrypt");
});
</script>
</body>
</html>
